## Оглавление
- [Каталог кейсов](#Каталог-кейсов)
- [Идентификация](#Идентификация-человека-на-изображении)


## Каталог кейсов

В данной директории находится каталог с кейсами, которые уже решены и могут быть использованы в дальнейшем.

Описание к каждому кейсу будет предложено в соответствующей главе.

## Идентификация человека на изображении

Для детектирования человека на изображении необходимо:
- Выбрать изображение, на котором есть лицо человека, которого надо идентифицировать или добавить в базу;

`Пример изображения`

<img alt="Скала Джонсон" src="image\\image.png" width="500" height="350">

<br>

- Далее найти в файле [person_Identification.ipynb](person_Identification.ipynb) ячейку с методом `analize_faces`;

- Вызвать метод, предав исходное изображение c нужными параметрами
    - `img_path` - путь к изображению
    - `new_person` - флаг, указывающий, нужно ли добавлять лицо человека в базу знаний
    - `plot` - флаг, указывающий, нужно ли отобразить изображение

`Пример вызова метода`

```python
analize_faces('..\\examples\\skala_1.png', new_person=True)
```
    

- После вызов метода первая модель `RetinaFace` выделяет лицо человека, вторая модель `ArcFace` возвращает embedding представления лица человека. После этого векторное представление записывается в файл `persons.parquet` с присвоенным ей ID

`Пример вывода изображения`

<img alt="Скала Джонсон" src="image\\output_1.jpg" width="500" height="350">

<br>

`Метод возвращает id и координаты лица для каждого человека найденного на кадре`

```json
{"id": ["person_0"], "coords": [[1284, 88, 337, 483]]}
```

- Для тестирования берём другое изображение, которое содержит лицо человека изменив параметр `new_person` на `False`;

`Пример изображения`

<img alt="Скала Джонсон и Вин Дизелем" src="image\\output_2.jpg" width="500" height="350">

<br>

Как видно на примере, лицо, которое было занесено в базу знаний, было определено корректно. Также видно, что человек, которого нет в базе, будет отображаться как `undefined`

`Вывод метода`

```json
{"id": ["person_0", "undefind_1"], "coords": [[562, 68, 132, 183], [817, 75, 131, 182]]}
```